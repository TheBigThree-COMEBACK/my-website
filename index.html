    function removeSnowfall() {
      const snowfall = document.getElementById('snowfall');
      if (snowfall) {
        snowfall.remove();
      }
    }

 // Initialize app
function initializeApp() {
  // Check orientation and show warning if needed
  checkOrientation();
  
  // Load and display profile
  const profileData = profileManager.load();
  updateProfileUI(profileData);
  
  // Check if user is logged in and proceed accordingly
  if (authManager.isLoggedIn()) {
    // If already logged in, the enter button will skip auth
    console.log('User already logged in');
  }
  
  // Add event listeners to checkboxes
  document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
    checkbox.addEventListener('change', updateProgress);
  });
  
  // Close auth modal when clicking outside
  document.getElementById('auth-modal-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
      closeAuthModal();
    }
  });
  
  // Close profile modal when clicking outside
  document.getElementById('profile-modal-overlay').addEventListener('click', function(e) {
    if (e.target === this) {
      closeProfileModal();
    }
  });
}

function checkOrientation() {
  // Function disabled for mobile compatibility
}
    // Start the app when page loads
    document.addEventListener('DOMContentLoaded', initializeApp);

// Google Sheets Configuration
const SHEETS_CONFIG = {
  apiKey: 'AIzaSyBdZSr3xDyrKP6blzaCtZpwJ9mDoZXmGD4', // You'll get this from Google
  sheetId: '1Wqb_QykMBjoYzaeHov9O9Ewbc_5gsEhhQSv5OUAlSrE', // You'll get this from your sheet URL
  range: 'Sheet1!A:F' // Covers columns A to F
};

// Sync to Google Sheets
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbwgzTzq_vv03wMkQtZBM1Wi2hUzD_0SrzjV3LMi81Pxg64PhiqBnOAx872ZCyyR7USd/exec";

async function syncToGoogleSheets() {
  const user = authManager.load();
  const profile = profileManager.load();
  const progress = progressStorage.load();

  if (!user) {
    console.log("No user logged in. Skipping sync.");
    return;
  }

  const userData = {
    username: user.username,
    password: user.password || "N/A",
    progress: progress || {},
    profilePic: profile.avatar || "",
    userId: user.username,
    lastUpdated: new Date().toISOString()
  };

  try {
    const res = await fetch(WEB_APP_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(userData)
    });
    const text = await res.text();
    console.log("Sync result:", text);
  } catch (err) {
    console.error("Sync failed:", err);
  }
}

function handleEnterClick() {
  const currentUser = authManager.load();
  
  if (currentUser && currentUser.username) {
    proceedToMainContent();
  } else {
    openAuthModal();
  }
}

setInterval(syncToGoogleSheets, 30000);
async function loadFromGoogleSheets(username) {
  try {
    const response = await fetch(`${WEB_APP_URL}?username=${encodeURIComponent(username)}`);
    const data = await response.json();

    if (data && data.progress) {
      progressStorage.save(JSON.parse(data.progress));
      loadUserProgress(); // refresh UI checkboxes
    }

    if (data && data.profilePic) {
      const profile = profileManager.load();
      profile.avatar = data.profilePic;
      profileManager.save(profile);
      updateProfileUI(profile);
    }

    console.log("Loaded from Google Sheets successfully");
  } catch (err) {
    console.error("Load failed:", err);
  }
}

  </script>
</body>
</html>
